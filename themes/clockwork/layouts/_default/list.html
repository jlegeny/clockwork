{{ partial "header.html" . }}

{{if not .IsHome }}
<h1>{{ .Title }}</h1>
{{ end }}

{{ .Content }}


{{ $paginator := .Paginate (where .Data.Pages "Section" "in" (slice "micros"  "posts")) }}

{{ range $paginator.Pages }}
<article itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    {{ if ne .Section "micros" }}
    <h1><a href="{{ .Permalink }}">{{ .Title }}</a></h1>
    {{ end }}
    <p>
    {{ if eq .Section "micros" }}<a href="{{ .Permalink }}">{{ end }}
    <time datetime="{{ .Date.Format "2006-01-02"}}">{{ .Date.Format "2006-01-02" }}</time>
    {{ if eq .Section "micros" }}</a>{{ end }}
    </p>
  </header>

  {{ $c := .Content }}
  {{ $c := $c | replaceRE "<h5(.*?)>(.*?)</h5>" "<h6$1>$2</h6>" }}
  {{ $c := $c | replaceRE "<h4(.*?)>(.*?)</h4>" "<h5$1>$2</h5>" }}
  {{ $c := $c | replaceRE "<h3(.*?)>(.*?)</h3>" "<h4$1>$2</h4>" }}
  {{ $c := $c | replaceRE "<h2(.*?)>(.*?)</h2>" "<h3$1>$2</h3>" }}
  {{ $c := $c | replaceRE "<h1(.*?)>(.*?)</h1>" "<h2$1>$2</h2>" }}
  {{ $c | markdownify}}

  <footer>
    <p class="tags">
    {{ range .Params.tags }}
    <a href="{{ "/tags/" | relLangURL }}{{ . | urlize }}">{{ . }}</a>
    {{ end }}
    </p>
  </footer>
</article>
{{ end }}

{{ $baseurl := .Site.BaseURL }}
<nav class="pagination">
  <ul>
    {{ if .Paginator.HasPrev }}
    <li><a href="{{ .Paginator.Prev.URL }}">&laquo; Prev</a></li>
    {{ else }}
    <li><span>&laquo; Prev</span></li>
    {{ end }}
 
    {{ range $paginator.Pagers }}
    {{ if eq .PageNumber $paginator.PageNumber }}</li>
    <li><span>{{ .PageNumber }}</span></li>
    {{ else }}
    <li><a href="{{ $baseurl }}{{ .URL }}">{{ .PageNumber }}</a></li>
    {{ end }}
    {{ end }}

    {{ if .Paginator.HasNext }}
    <li><a href="{{ .Paginator.Next.URL }}">Next &raquo;</a></li>
    {{ else }}
    <li><span>Next &raquo;</span></li>
    {{ end }}
  </ul>
</nav>

{{ partial "footer.html" . }}
